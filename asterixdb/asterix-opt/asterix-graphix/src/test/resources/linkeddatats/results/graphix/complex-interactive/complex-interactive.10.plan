distribute result [$$954] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
-- DISTRIBUTE_RESULT  |UNPARTITIONED|
  exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
  -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
    limit 10 [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
    -- STREAM_LIMIT  |UNPARTITIONED|
      project ([$$954]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
      -- STREAM_PROJECT  |PARTITIONED|
        assign [$$954] <- [{"personId": $$963, "personFirstName": $$1012, "personLastName": $$1013, "commonInterestScore": $$commonInterestScore, "personGender": $$1014, "personCityName": $$1015}] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
        -- ASSIGN  |PARTITIONED|
          exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
          -- SORT_MERGE_EXCHANGE [$$commonInterestScore(DESC), $$963(ASC) ]  |PARTITIONED|
            limit 10 [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
            -- STREAM_LIMIT  |PARTITIONED|
              exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                order (topK: 10) (DESC, $$commonInterestScore) (ASC, $$963) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                -- STABLE_SORT [topK: 10] [$$commonInterestScore(DESC), $$963(ASC)]  |PARTITIONED|
                  exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                    project ([$$963, $$1012, $$1013, $$commonInterestScore, $$1014, $$1015]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                    -- STREAM_PROJECT  |PARTITIONED|
                      select (not(neq($$991, 0))) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                      -- STREAM_SELECT  |PARTITIONED|
                        project ([$$991, $$963, $$commonInterestScore, $$1012, $$1013, $$1014, $$1015]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                        -- STREAM_PROJECT  |PARTITIONED|
                          exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                            group by ([$$1023 := $$1031]) decor ([$$963; $$commonInterestScore; $$1012; $$1013; $$1014; $$1015]) {
                                      aggregate [$$991] <- [agg-sum($$1030)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                      -- AGGREGATE  |LOCAL|
                                        nested tuple source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                        -- NESTED_TUPLE_SOURCE  |LOCAL|
                                   } [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                            -- SORT_GROUP_BY[$$1031]  |PARTITIONED|
                              exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                              -- HASH_PARTITION_EXCHANGE [$$1031]  |PARTITIONED|
                                group by ([$$1031 := $$1021]) decor ([$$963; $$commonInterestScore; $$1012; $$1013; $$1014; $$1015]) {
                                          aggregate [$$1030] <- [agg-count({"$1": 1})] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                          -- AGGREGATE  |LOCAL|
                                            select (and(eq($$970, $$963), not(eq($$969, $$970)), not(is-missing($$1022)))) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                            -- STREAM_SELECT  |LOCAL|
                                              nested tuple source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                              -- NESTED_TUPLE_SOURCE  |LOCAL|
                                       } [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                -- PRE_CLUSTERED_GROUP_BY[$$1021]  |PARTITIONED|
                                  exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                    order (ASC, $$1021) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                    -- STABLE_SORT [$$1021(ASC)]  |PARTITIONED|
                                      exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                        project ([$$963, $$1012, $$1013, $$commonInterestScore, $$1014, $$1015, $$970, $$969, $$1022, $$1021]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                        -- STREAM_PROJECT  |PARTITIONED|
                                          exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                            left outer join (eq($$969, $$960)) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                            -- HYBRID_HASH_JOIN [$$960][$$969]  |PARTITIONED|
                                              exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                              -- HASH_PARTITION_EXCHANGE [$$960]  |PARTITIONED|
                                                project ([$$963, $$1012, $$1013, $$commonInterestScore, $$1014, $$1015, $$1021, $$960]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                -- STREAM_PROJECT  |PARTITIONED|
                                                  assign [$$commonInterestScore] <- [numeric-subtract($$985, numeric-subtract($$986, $$985))] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                  -- ASSIGN  |PARTITIONED|
                                                    exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                      group by ([$$1021 := $$1018]) decor ([$$960; $$963; $$1012; $$1013; $$1014; $$1015; $$986]) {
                                                                aggregate [$$985] <- [agg-sql-count($$fp)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                -- AGGREGATE  |LOCAL|
                                                                  distinct ([$$fp]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                  -- MICRO_PRE_SORTED_DISTINCT_BY  |LOCAL|
                                                                    order (ASC, $$fp) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                    -- MICRO_STABLE_SORT [$$fp(ASC)]  |LOCAL|
                                                                      select (not(is-missing($$1020))) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                      -- STREAM_SELECT  |LOCAL|
                                                                        nested tuple source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                        -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                             } [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                      -- PRE_CLUSTERED_GROUP_BY[$$1018]  |PARTITIONED|
                                                        exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                          order (ASC, $$1018) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                          -- STABLE_SORT [$$1018(ASC)]  |PARTITIONED|
                                                            exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                            -- HASH_PARTITION_EXCHANGE [$$1018]  |PARTITIONED|
                                                              project ([$$963, $$1012, $$1013, $$1014, $$1015, $$960, $$986, $$fp, $$1020, $$1018]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                              -- STREAM_PROJECT  |PARTITIONED|
                                                                exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                  left outer join (and(eq($$968, $$tagId), eq($$967, $$960))) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                  -- HYBRID_HASH_JOIN [$$tagId, $$960][$$968, $$967]  |PARTITIONED|
                                                                    exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                    -- HASH_PARTITION_EXCHANGE [$$tagId, $$960]  |PARTITIONED|
                                                                      project ([$$963, $$1012, $$1013, $$1014, $$1015, $$960, $$986, $$fp, $$1018, $$tagId]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                      -- STREAM_PROJECT  |PARTITIONED|
                                                                        select ($$1065) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                        -- STREAM_SELECT  |PARTITIONED|
                                                                          project ([$$986, $$1018, $$960, $$963, $$1012, $$1013, $$1014, $$1015, $$fp, $$tagId, $$1065]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                          -- STREAM_PROJECT  |PARTITIONED|
                                                                            window-aggregate [$$1065] <- [win-mark-first-missing-impl($$966)] partition [$$1064] order (DESC, $$966) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                            -- WINDOW_STREAM  |PARTITIONED|
                                                                              exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                order (ASC, $$1064) (DESC, $$966) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                -- STABLE_SORT [$$1064(ASC), $$966(DESC)]  |PARTITIONED|
                                                                                  exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                  -- HASH_PARTITION_EXCHANGE [$$1064]  |PARTITIONED|
                                                                                    select (not(is-unknown($$tagId))) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                    -- STREAM_SELECT  |PARTITIONED|
                                                                                      project ([$$986, $$1018, $$960, $$963, $$1012, $$1013, $$1014, $$1015, $$1064, $$fp, $$966, $$tagId]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                      -- STREAM_PROJECT  |PARTITIONED|
                                                                                        unnest $$tagId <- scan-collection($$1008) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                        -- UNNEST  |PARTITIONED|
                                                                                          project ([$$986, $$1018, $$960, $$963, $$1012, $$1013, $$1014, $$1015, $$1064, $$fp, $$966, $$1008]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                          -- STREAM_PROJECT  |PARTITIONED|
                                                                                            assign [$$1008] <- [$$m.getField(13)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                            -- ASSIGN  |PARTITIONED|
                                                                                              exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                left-outer-unnest-map [$$966, $$m] <- index-search("Messages", 0, "SNB/Native", "Messages", true, true, 1, $$fp, 1, $$fp, true, true, true) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                -- BTREE_SEARCH  |PARTITIONED|
                                                                                                  exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                    order (ASC, $$fp) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                    -- STABLE_SORT [$$fp(ASC)]  |PARTITIONED|
                                                                                                      exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                      -- HASH_PARTITION_EXCHANGE [$$fp]  |PARTITIONED|
                                                                                                        project ([$$986, $$1018, $$960, $$963, $$1012, $$1013, $$1014, $$1015, $$1064, $$fp]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                        -- STREAM_PROJECT  |PARTITIONED|
                                                                                                          unnest $$fp <- scan-collection($$863) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                          -- UNNEST  |PARTITIONED|
                                                                                                            running-aggregate [$$1064] <- [create-query-uid()] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                            -- RUNNING_AGGREGATE  |PARTITIONED|
                                                                                                              exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                group by ([$$1018 := $$1016]) decor ([$$960; $$963; $$1012; $$1013; $$1014; $$1015]) {
                                                                                                                          aggregate [$$863, $$986] <- [listify($$965), agg-sql-count($$965)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                          -- AGGREGATE  |LOCAL|
                                                                                                                            select (not(is-missing($$965))) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                            -- STREAM_SELECT  |LOCAL|
                                                                                                                              nested tuple source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                              -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                                                                                       } [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                -- PRE_CLUSTERED_GROUP_BY[$$1016]  |PARTITIONED|
                                                                                                                  exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                    order (ASC, $$1016) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                    -- STABLE_SORT [$$1016(ASC)]  |PARTITIONED|
                                                                                                                      exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                      -- HASH_PARTITION_EXCHANGE [$$1016]  |PARTITIONED|
                                                                                                                        project ([$$963, $$1012, $$1013, $$1014, $$1015, $$960, $$965, $$1016]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                        -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                          select (eq($$1005, $$963)) retain-untrue ($$965 <- missing) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                          -- STREAM_SELECT  |PARTITIONED|
                                                                                                                            project ([$$963, $$1012, $$1013, $$1014, $$1015, $$960, $$1016, $$965, $$1005]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                            -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                              select (and($COPY_OF(post,1).getField(12), not(is-unknown($$1005)))) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                              -- STREAM_SELECT  |PARTITIONED|
                                                                                                                                assign [$$1005] <- [$COPY_OF(post,1).getField(8)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                -- ASSIGN  |PARTITIONED|
                                                                                                                                  project ([$$963, $$1012, $$1013, $$1014, $$1015, $$960, $$1016, $$965, $COPY_OF(post,1)]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                    exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                      left-outer-unnest-map [$$965, $COPY_OF(post,1)] <- index-search("Messages", 0, "SNB/Native", "Messages", true, false, 1, $$1061, 1, $$1061, true, true, true) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                      -- BTREE_SEARCH  |PARTITIONED|
                                                                                                                                        exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                          order (ASC, $$1061) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                          -- STABLE_SORT [$$1061(ASC)]  |PARTITIONED|
                                                                                                                                            exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                              project ([$$963, $$1012, $$1013, $$1014, $$1015, $$960, $$1016, $$1061]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                              -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                                exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                  left-outer-unnest-map [$$1060, $$1061] <- index-search("messageCreatorIdIndex", 0, "SNB/Native", "Messages", true, true, 1, $$963, 1, $$963, true, true, true) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                  -- BTREE_SEARCH  |PARTITIONED|
                                                                                                                                                    exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                    -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                                                                                                                      project ([$$963, $$1012, $$1013, $$1014, $$1015, $$960, $$1016]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                      -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                                        select (or(and(eq($$1067, 10), ge($$1068, 21)), and(eq($$1067, 4), lt($$1068, 22)))) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                        -- STREAM_SELECT  |PARTITIONED|
                                                                                                                                                          project ([$$963, $$1012, $$1013, $$1014, $$1015, $$960, $$1016, $$1068, $$1067]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                          -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                                            assign [$$1068, $$1067] <- [get-day($$959), get-month($$959)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                            -- ASSIGN  |PARTITIONED|
                                                                                                                                                              running-aggregate [$$1016] <- [create-query-uid()] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                              -- RUNNING_AGGREGATE  |PARTITIONED|
                                                                                                                                                                project ([$$963, $$1012, $$1013, $$1014, $$1015, $$960, $$959]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                                                  assign [$$1015] <- [$COPY_OF(city,1).getField(1)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                  -- ASSIGN  |PARTITIONED|
                                                                                                                                                                    project ([$$960, $$963, $$1014, $$1013, $$1012, $$959, $COPY_OF(city,1)]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                    -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                                                      exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                                        unnest-map [$$964, $COPY_OF(city,1)] <- index-search("Cities", 0, "SNB/Native", "Cities", true, true, 1, $$1001, 1, $$1001, true, true, true) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                        -- BTREE_SEARCH  |PARTITIONED|
                                                                                                                                                                          exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                                            order (ASC, $$1001) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                            -- STABLE_SORT [$$1001(ASC)]  |PARTITIONED|
                                                                                                                                                                              exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                              -- HASH_PARTITION_EXCHANGE [$$1001]  |PARTITIONED|
                                                                                                                                                                                project ([$$960, $$963, $$1014, $$1013, $$1012, $$959, $$1001]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                                                                  assign [$$1014, $$1013, $$1012, $$959, $$1001] <- [$COPY_OF(friend,9).getField(3), $COPY_OF(friend,9).getField(2), $COPY_OF(friend,9).getField(1), $COPY_OF(friend,9).getField(4), $COPY_OF(friend,9).getField(8)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                  -- ASSIGN  |PARTITIONED|
                                                                                                                                                                                    select (not(eq($$960, $$963))) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                    -- STREAM_SELECT  |PARTITIONED|
                                                                                                                                                                                      project ([$$960, $$963, $COPY_OF(friend,9)]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                      -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                                                                        exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                                                          unnest-map [$$963, $COPY_OF(friend,9)] <- index-search("Persons", 0, "SNB/Native", "Persons", true, true, 1, $$987, 1, $$987, true, true, true) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                          -- BTREE_SEARCH  |PARTITIONED|
                                                                                                                                                                                            exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                                                              order (ASC, $$987) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                              -- STABLE_SORT [$$987(ASC)]  |PARTITIONED|
                                                                                                                                                                                                exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                -- HASH_PARTITION_EXCHANGE [$$987]  |PARTITIONED|
                                                                                                                                                                                                  project ([$$960, $$987]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                                                                                    select (and(ge($$1066, 2), le($$1066, 2))) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                    -- STREAM_SELECT  |PARTITIONED|
                                                                                                                                                                                                      project ([$$960, $$1066, $$987]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                      -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                                                                                        assign [$$1066, $$987] <- [optimized-edge-count($COPY_OF(#2,14)), $COPY_OF(friend,7).getField(0)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                        -- ASSIGN  |PARTITIONED|
                                                                                                                                                                                                          project ([$COPY_OF(#2,14), $COPY_OF(friend,7), $$960]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                          -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                                                                                            marker-sink [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                            -- MARKER_SINK  |PARTITIONED|
                                                                                                                                                                                                              exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                              -- STATE_RELEASE (ONE_TO_ONE_EXCHANGE)  |PARTITIONED|
                                                                                                                                                                                                                recursive-head [$COPY_OF(#2,11) <- $COPY_OF(#2,14),$#9 <- $COPY_OF(friend,7),$#19 <- $#21] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                -- RECURSIVE_HEAD  |PARTITIONED|
                                                                                                                                                                                                                  exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                  -- STATE_RELEASE (ONE_TO_ONE_EXCHANGE)  |PARTITIONED|
                                                                                                                                                                                                                    project ([$COPY_OF(#2,14), $COPY_OF(friend,7), $#21, $$960]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                    -- STATE_RELEASE (STREAM_PROJECT)  |PARTITIONED|
                                                                                                                                                                                                                      exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                      -- STATE_RELEASE (ONE_TO_ONE_EXCHANGE)  |PARTITIONED|
                                                                                                                                                                                                                        fixed-point [$COPY_OF(#2,14) <- ($COPY_OF(#2,10),$COPY_OF(#2,12)) $COPY_OF(friend,7) <- ($COPY_OF(friend,6),$COPY_OF(#10,1)) $#21 <- ($#18,$#20)] {
                                                                                                                                                                                                                                  exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                                  -- STATE_RELEASE (ONE_TO_ONE_EXCHANGE)  |PARTITIONED|
                                                                                                                                                                                                                                    project ([$COPY_OF(#2,12), $COPY_OF(#10,1), $#20, $$960]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                                    -- STATE_RELEASE (STREAM_PROJECT)  |PARTITIONED|
                                                                                                                                                                                                                                      assign [$COPY_OF(#2,12)] <- [append-to-existing-path($COPY_OF(#10,1), $COPY_OF(#11,1), $COPY_OF(#2,11))] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                                      -- STATE_RELEASE (ASSIGN)  |PARTITIONED|
                                                                                                                                                                                                                                        select (is-distinct-everything($COPY_OF(#10,1), $COPY_OF(#11,1), $COPY_OF(#2,11))) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                                        -- STATE_RELEASE (STREAM_SELECT)  |PARTITIONED|
                                                                                                                                                                                                                                          assign [$#20, $COPY_OF(#10,1)] <- [0, {"id": $$962}] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                                          -- STATE_RELEASE (ASSIGN)  |PARTITIONED|
                                                                                                                                                                                                                                            exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                                            -- STATE_RELEASE (ONE_TO_ONE_EXCHANGE)  |PARTITIONED|
                                                                                                                                                                                                                                              unnest-map [$$961, $$962, $COPY_OF(#11,1)] <- index-search("Knows", 0, "SNB/Native", "Knows", true, true, 1, $$996, 1, $$996, true, true, true) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                                              -- STATE_RELEASE (BTREE_SEARCH)  |PARTITIONED|
                                                                                                                                                                                                                                                exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                                                -- STATE_RELEASE (BROADCAST_EXCHANGE)  |PARTITIONED|
                                                                                                                                                                                                                                                  assign [$$996] <- [$#9.getField(0)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                                                  -- STATE_RELEASE (ASSIGN)  |PARTITIONED|
                                                                                                                                                                                                                                                    select (le(optimized-edge-count($COPY_OF(#2,11)), 2)) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                                                    -- STATE_RELEASE (STREAM_SELECT)  |PARTITIONED|
                                                                                                                                                                                                                                                      recursive-tail [$COPY_OF(#2,11) <- ($COPY_OF(#2,10),$COPY_OF(#2,14)), $#9 <- ($COPY_OF(friend,6),$COPY_OF(friend,7)), $#19 <- ($#18,$#21)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                                                      -- RECURSIVE_TAIL  |PARTITIONED|
                                                                                                                                                                                                                               } [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                        -- FIXED_POINT  |PARTITIONED|
                                                                                                                                                                                                                          exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                                                                                            project ([$COPY_OF(#2,10), $COPY_OF(friend,6), $#18, $$960]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                            -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                                                                                                              assign [$#18, $COPY_OF(#2,10)] <- [0, create-new-zero-hop-path($COPY_OF(friend,6))] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                              -- ASSIGN  |PARTITIONED|
                                                                                                                                                                                                                                assign [$COPY_OF(friend,6)] <- [{"id": $$960}] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                                -- ASSIGN  |PARTITIONED|
                                                                                                                                                                                                                                  project ([$$960]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                                                                                                                    exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                                                                                                      unnest-map [$$960, $COPY_OF(person,6)] <- index-search("Persons", 0, "SNB/Native", "Persons", false, false, 1, $$1036, 1, $$1037, true, true, true) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                                      -- BTREE_SEARCH  |PARTITIONED|
                                                                                                                                                                                                                                        exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                                                                                                          replicate [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                                          -- REPLICATE  |PARTITIONED|
                                                                                                                                                                                                                                            exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                                                                                                              assign [$$1036, $$1037] <- [14, 14] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                                              -- ASSIGN  |PARTITIONED|
                                                                                                                                                                                                                                                empty-tuple-source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                                                                                                                -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                    exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                    -- HASH_PARTITION_EXCHANGE [$$968, $$967]  |PARTITIONED|
                                                                      assign [$$1020] <- [true] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                      -- ASSIGN  |PARTITIONED|
                                                                        project ([$$967, $$968]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                        -- STREAM_PROJECT  |PARTITIONED|
                                                                          exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                            unnest-map [$$967, $$968, $COPY_OF(#7,1)] <- index-search("PersonTag", 0, "SNB/Native", "PersonTag", false, false, 1, $$1046, 1, $$1047, true, true, true) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                            -- BTREE_SEARCH  |PARTITIONED|
                                                                              exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                project ([$$1046, $$1047]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                -- STREAM_PROJECT  |PARTITIONED|
                                                                                  assign [$$1046, $$1047] <- [$$1036, $$1037] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                  -- ASSIGN  |PARTITIONED|
                                                                                    exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                      replicate [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                      -- REPLICATE  |PARTITIONED|
                                                                                        exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                          assign [$$1036, $$1037] <- [14, 14] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                          -- ASSIGN  |PARTITIONED|
                                                                                            empty-tuple-source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                            -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                              exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                              -- HASH_PARTITION_EXCHANGE [$$969]  |PARTITIONED|
                                                assign [$$1022] <- [true] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                -- ASSIGN  |PARTITIONED|
                                                  project ([$$969, $$970]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                    exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                      unnest-map [$$969, $$970, $COPY_OF(#8,1)] <- index-search("Knows", 0, "SNB/Native", "Knows", false, false, 1, $$1054, 1, $$1055, true, true, true) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                      -- BTREE_SEARCH  |PARTITIONED|
                                                        exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                          project ([$$1054, $$1055]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                          -- STREAM_PROJECT  |PARTITIONED|
                                                            assign [$$1054, $$1055] <- [$$1036, $$1037] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                            -- ASSIGN  |PARTITIONED|
                                                              exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                replicate [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                -- REPLICATE  |PARTITIONED|
                                                                  exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                    assign [$$1036, $$1037] <- [14, 14] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                    -- ASSIGN  |PARTITIONED|
                                                                      empty-tuple-source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                      -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
